<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>LG 6 MAP</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script src="https://cdn.jsdelivr.net/npm/togeojson@0.16.0/dist/togeojson.umd.js"></script>
  <!-- config.js injected at build time (contains window.__MAPS_API_KEY) -->
  <script src="/config.js"></script>

  <!-- Load Google Maps dynamically after config in main.js initializes -->
  <!-- main.js will inject the Maps script using window.__MAPS_API_KEY -->
</head>
<body>
  <header class="appbar">
    <h1>LG 6 MAP</h1>
    <div class="actions">
      <button id="openHistoryMobile" class="hamburger d-md-none" title="History (mobile)">‚ò∞</button>
    </div>
  </header>

  <main class="page">
    <div class="map-card" role="region" aria-label="Map container">
      <!-- Compact toolbar: only icon when collapsed; expands horizontally in draw mode -->
      <div id="toolbar" class="toolbar collapsed" aria-label="Drawing toolbar">
        <button id="toolToggle" class="tool-icon" title="Toggle draw tools">‚úèÔ∏è</button>

        <!-- expanded controls -->
        <div id="toolbarControls" class="controls" aria-hidden="true">
          <div class="control-group">
            <label class="label">Color</label>
            <select id="colorSelect" class="select">
              <option value="#ff0000" selected>Red</option>
              <option value="#007bff">Blue</option>
              <option value="#16a34a">Green</option>
              <option value="#ffff00">Yellow</option>
              <option value="#ffffff">White</option>
              <option value="#000000">Black</option>
            </select>
          </div>

          <div class="control-group">
            <label class="label">Size</label>
            <select id="sizeSelect" class="select">
              <option value="3">3 px</option>
              <option value="5" selected>5 px</option>
              <option value="10">10 px</option>
            </select>
          </div>

          <button id="undoBtn" class="tool-small" title="Undo last stroke">‚Ü∂</button>
          <button id="eraseModeBtn" class="tool-small" title="Toggle erase mode">ü©π</button>
          <button id="eraseAllBtn" class="tool-small danger" title="Erase all drawings">üóëÔ∏è</button>
          <button id="saveDrawBtn" class="tool-small" title="Save drawings">üíæ</button>
        </div>
      </div>

      <div id="map"></div>
    </div>

    <aside class="history-panel d-none d-md-block" id="historyPanelDesktop" aria-label="History Panel">
      <h4 style="margin-top:4px">History & Logs</h4>
      <p class="muted" style="margin-bottom:10px">Saved marker changes are shown here (click to review).</p>
      <div id="historyList"></div>
      <div style="margin-top:12px">
        <button id="resetAll" class="btn btn-outline-secondary w-100">Reset All Saved</button>
      </div>
    </aside>
  </main>

  <div class="offcanvas offcanvas-end" tabindex="-1" id="mobileHistory" aria-labelledby="mobileHistoryLabel">
    <div class="offcanvas-header">
      <h5 id="mobileHistoryLabel">History</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div id="historyListMobile"></div>
      <div class="mt-3">
        <button id="resetAllMobile" class="btn btn-outline-secondary w-100">Reset All Saved</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/main.js"></script>
</body>
</html>
